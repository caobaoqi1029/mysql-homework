"use strict";(self["webpackChunkstu_score_front"]=self["webpackChunkstu_score_front"]||[]).push([[64],{4064:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"findAdd"},[t("el-input",{staticStyle:{width:"240px"},attrs:{autocomplete:"off",placeholder:"请输入学号",clearable:""},model:{value:e.stuId,callback:function(t){e.stuId=t},expression:"stuId"}}),t("el-input",{staticStyle:{width:"240px"},attrs:{autocomplete:"off",placeholder:"请输入学生姓名",clearable:""},model:{value:e.stuName,callback:function(t){e.stuName=t},expression:"stuName"}}),t("el-input",{staticStyle:{width:"240px"},attrs:{autocomplete:"off",placeholder:"请输入班级名称",clearable:""},model:{value:e.className,callback:function(t){e.className=t},expression:"className"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchStuList}},[e._v("搜索")]),t("el-button",{staticStyle:{"margin-left":"0"},attrs:{icon:"el-icon-refresh"},on:{click:e.resetStuList}},[e._v("刷新")]),t("el-button",{staticStyle:{"margin-left":"45px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddStu}},[e._v("新增学生")]),t("a",{staticStyle:{"text-decoration":"none",color:"purple"},attrs:{href:"https://www.soba8.com/shenfenzheng/",target:"_blank"}},[e._v("（样本数据）")])],1),t("div",{staticClass:"stuTable"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.stuList,stripe:"",size:"small"}},[t("el-table-column",{attrs:{label:"序号",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.pageNum-1)*e.pageSize+t.$index+1)+" ")]}}])}),t("el-table-column",{attrs:{prop:"stuId",label:"学号",sortable:"",align:"center",width:"130"}}),t("el-table-column",{attrs:{prop:"stuName",label:"学生姓名",align:"center",sortable:"",width:"150"}}),t("el-table-column",{attrs:{prop:"majorName",sortable:"",align:"center",width:"200",label:"专业名称"}}),t("el-table-column",{attrs:{prop:"className",align:"center",width:"220",label:"班级名称",sortable:""}}),t("el-table-column",{attrs:{prop:"teaName",sortable:"",align:"center",width:"150",label:"班主任姓名"}}),t("el-table-column",{attrs:{prop:"handle",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openStuScore(a.row)}}},[e._v("打分")]),t("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(t){return e.openEditStu(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.delStu(a.row)}}},[e._v("删除")])]}}])})],1)],1),t("div",{staticClass:"page"},[t("el-pagination",{attrs:{"pager-count":11,background:"","current-page":e.pageNum,"page-size":e.pageSize,"page-sizes":[5,10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),t("div",{staticClass:"addStuDialog"},[t("el-dialog",{attrs:{title:"新增学生",visible:e.addFormVisible},on:{close:e.clearAddForm,"update:visible":function(t){e.addFormVisible=t}}},[t("el-form",{ref:"addStuFormRef",attrs:{model:e.addStuForm,rules:e.addRules}},[t("el-form-item",{attrs:{label:"入学年份","label-width":"150px",prop:"admissionYear"}},[t("el-select",{attrs:{placeholder:"请选择入学年份",clearable:""},on:{change:function(t){return e.add_Year(e.addStuForm)}},model:{value:e.addStuForm.admissionYear,callback:function(t){e.$set(e.addStuForm,"admissionYear",t)},expression:"addStuForm.admissionYear"}},e._l(e.admissionYears,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1)],1),t("el-form-item",{attrs:{label:"专业","label-width":"150px",prop:"majorName"}},[t("el-select",{attrs:{placeholder:"请选择专业",clearable:""},on:{change:function(t){return e.add_Major(e.addStuForm)}},model:{value:e.addStuForm.majorName,callback:function(t){e.$set(e.addStuForm,"majorName",t)},expression:"addStuForm.majorName"}},e._l(e.majorNames,(function(e){return t("el-option",{key:e.majorId,attrs:{label:e.majorName,value:e.majorName}})})),1)],1),t("el-form-item",{attrs:{label:"班号","label-width":"150px",prop:"classId"}},[t("el-select",{attrs:{placeholder:"请选择班号",clearable:"",id:"selectClassId"},model:{value:e.addStuForm.classId,callback:function(t){e.$set(e.addStuForm,"classId",t)},expression:"addStuForm.classId"}},e._l(e.classNos,(function(e){return t("el-option",{key:e.classId,attrs:{label:e.classId.substring(6,7),value:e.classId}})})),1)],1),t("el-form-item",{attrs:{label:"学生姓名","label-width":"150px",prop:"stuName"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入学生姓名",clearable:""},model:{value:e.addStuForm.stuName,callback:function(t){e.$set(e.addStuForm,"stuName",t)},expression:"addStuForm.stuName"}})],1),t("el-form-item",{attrs:{label:"身份证","label-width":"150px",prop:"stuIdCard"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入身份证",clearable:""},model:{value:e.addStuForm.stuIdCard,callback:function(t){e.$set(e.addStuForm,"stuIdCard",t)},expression:"addStuForm.stuIdCard"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelAdd}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addStu}},[e._v("确 定")])],1)],1)],1),t("div",{staticClass:"editStuDialog"},[t("el-dialog",{attrs:{title:"编辑学生",visible:e.editFormVisible},on:{close:e.clearEditForm,"update:visible":function(t){e.editFormVisible=t}}},[t("el-form",{ref:"editStuFormRef",attrs:{model:e.editStuForm,rules:e.editRules}},[t("el-form-item",{attrs:{label:"学号","label-width":"150px",prop:"stuId"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editStuForm.stuId,callback:function(t){e.$set(e.editStuForm,"stuId",t)},expression:"editStuForm.stuId"}})],1),t("el-form-item",{attrs:{label:"入学年份","label-width":"150px",prop:"admissionYear"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editStuForm.admissionYear,callback:function(t){e.$set(e.editStuForm,"admissionYear",t)},expression:"editStuForm.admissionYear"}})],1),t("el-form-item",{attrs:{label:"专业","label-width":"150px",prop:"majorName"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editStuForm.majorName,callback:function(t){e.$set(e.editStuForm,"majorName",t)},expression:"editStuForm.majorName"}})],1),t("el-form-item",{attrs:{label:"班号","label-width":"150px",prop:"classId"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editStuForm.classNo,callback:function(t){e.$set(e.editStuForm,"classNo",t)},expression:"editStuForm.classNo"}})],1),t("el-form-item",{attrs:{label:"学生姓名","label-width":"150px",prop:"stuName"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入学生姓名",clearable:""},model:{value:e.editStuForm.stuName,callback:function(t){e.$set(e.editStuForm,"stuName",t)},expression:"editStuForm.stuName"}})],1),t("el-form-item",{attrs:{label:"身份证","label-width":"150px",prop:"stuIdCard"}},[t("el-input",{attrs:{placeholder:"请输入身份证",disabled:""},model:{value:e.editStuForm.stuIdCard,callback:function(t){e.$set(e.editStuForm,"stuIdCard",t)},expression:"editStuForm.stuIdCard"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelEdit}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.editStu}},[e._v("确 定")])],1)],1)],1),t("div",{staticClass:"scoreStuDialog"},[t("el-dialog",{attrs:{title:"学生打分",visible:e.scoreFormVisible},on:{close:e.clearScoreForm,"update:visible":function(t){e.scoreFormVisible=t}}},[t("el-form",{ref:"scoreStuFormRef",attrs:{model:e.scoreStuForm,rules:e.scoreRules}},[t("el-form-item",{attrs:{label:"学号","label-width":"150px",prop:"stuId"}},[t("el-input",{attrs:{disabled:""},model:{value:e.scoreStuForm.stuId,callback:function(t){e.$set(e.scoreStuForm,"stuId",t)},expression:"scoreStuForm.stuId"}})],1),t("el-form-item",{attrs:{label:"学生姓名","label-width":"150px",prop:"stuName"}},[t("el-input",{attrs:{disabled:""},model:{value:e.scoreStuForm.stuName,callback:function(t){e.$set(e.scoreStuForm,"stuName",t)},expression:"scoreStuForm.stuName"}})],1),t("el-form-item",{attrs:{label:"课程","label-width":"150px",prop:"courseName"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择课程"},on:{change:e.getScore},model:{value:e.scoreStuForm.courseName,callback:function(t){e.$set(e.scoreStuForm,"courseName",t)},expression:"scoreStuForm.courseName"}},e._l(e.courseNames,(function(e){return t("el-option",{key:e.courseId,attrs:{label:e.courseName,value:e.courseName}})})),1)],1),t("el-form-item",{attrs:{label:"分数","label-width":"150px",prop:"score"}},[t("el-input",{attrs:{clearable:"",placeholder:"请给予分数",type:"number"},model:{value:e.scoreStuForm.score,callback:function(t){e.$set(e.scoreStuForm,"score",t)},expression:"scoreStuForm.score"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelScore}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.scoreStu}},[e._v("确 定")])],1)],1)],1),t("el-backtop",{attrs:{"visibility-height":200}},[t("div",{staticStyle:{"{\n      height":"100%",width:"100%","background-color":"#f2f5f6","box-shadow":"0 0 6px rgba(0,0,0, .30)","text-align":"center","line-height":"40px",color:"#1989fa"}},[e._v(" ↑ ")])])],1)},r=[],o=a(4161),l=a(7344),i={name:"StuManage",data(){let e=new Date,t=e.getFullYear(),a=t-1,s=new Date(t+"-9-01 00:00:00");e>s&&(a+=1);let r=(e,t,a)=>{let s=/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|[xX])$/;if(!s.test(t))return a(new Error("身份证格式错误"));a()},o=(e,t,a)=>t<0||t>100?a(new Error("分数范围在0到100之间")):void a();return{addStuForm:{admissionYear:"",majorName:"",classId:"",stuName:"",stuIdCard:""},editStuForm:{stuId:"",admissionYear:"",majorName:"",classNo:"",stuName:"",stuIdCard:""},scoreStuForm:{score:"",courseName:""},courseNames:[],pageNum:1,pageSize:100,stuId:"",stuName:"",className:"",total:0,addFormVisible:!1,editFormVisible:!1,scoreFormVisible:!1,stuList:[],admissionYears:[{value:"1",label:a},{value:"2",label:a-1},{value:"3",label:a-2},{value:"4",label:a-3}],majorNames:[],classNos:[],addRules:{admissionYear:{required:!0,message:"请选择入学年份",trigger:"blur"},majorName:{required:!0,message:"请选择专业",trigger:"blur"},classId:{required:!0,message:"请选择班号",trigger:"blur"},stuName:[{required:!0,message:"请输入学生姓名",trigger:"blur"},{min:2,max:20,message:"姓名长度为2到20个字符",trigger:"blur"}],stuIdCard:[{required:!0,message:"请输入身份证",trigger:"blur"},{validator:r,trigger:"blur"}]},editRules:{stuName:[{required:!0,message:"请输入学生姓名",trigger:"blur"},{min:2,max:20,message:"姓名长度为2到20个字符",trigger:"blur"}]},scoreRules:{courseName:{required:!0,message:"请选择课程",trigger:"blur"},score:[{required:!0,message:"请给予分数",trigger:"blur"},{validator:o,trigger:"blur"}]}}},created(){this.getStuList()},methods:{scoreStu(){this.$refs.scoreStuFormRef.validate((e=>{if(!e)return!1;o.Z.put(l.Z.baseURL+"/score/giveNewScore",this.scoreStuForm,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.scoreFormVisible=!1,this.clearScoreForm(),this.getStuList(),this.$message.success(e.data.msg)):this.$message.error(e.data.msg)}))}))},getScore(){o.Z.get(l.Z.baseURL+"/score/getScoreByCourseName?courseName="+this.scoreStuForm.courseName+"&stuId="+this.scoreStuForm.stuId,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code&&null!=e.data.data&&this.$message.info(this.scoreStuForm.courseName+"成绩为"+e.data.data)}))},add_Year(e){this.$set(this.addStuForm,"classId",""),""!=e.majorName&&void 0!=e.majorName&&""!=e.admissionYear&&void 0!=e.admissionYear&&this.getClasses(e)},add_Major(e){this.$set(this.addStuForm,"classId",""),""!=e.majorName&&void 0!=e.majorName&&""!=e.admissionYear&&void 0!=e.admissionYear&&this.getClasses(e)},getClasses(e){o.Z.get(l.Z.baseURL+"/class/getClassesByMajorName?majorName="+e.majorName+"&classYear="+e.admissionYear,{headers:{Authorization:this.$store.state.token}}).then((e=>{(e.code="20000")&&(this.classNos=e.data.data)}))},resetStuList(){location.reload()},searchStuList(){this.pageNum=1,this.getStuList()},cancelEdit(){this.editFormVisible=!1,this.clearAddForm(),this.$message.info("已取消编辑")},cancelAdd(){this.addFormVisible=!1,this.classNos=[],this.clearAddForm(),this.$set(this.addStuForm,"classId",""),this.$message.info("已取消新增")},cancelScore(){this.scoreFormVisible=!1,this.clearScoreForm(),this.$message.info("已取消打分")},delStu(e){this.$confirm(`确认删除学生：${e.stuName} ？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((()=>{o.Z["delete"](l.Z.baseURL+"/student/delete?stuId="+e.stuId,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.getStuList(),this.$message.success(e.data.msg)):this.$message.error(e.data.msg)}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},openStuScore(e){o.Z.get(l.Z.baseURL+"/student/getByStuId?stuId="+e.stuId,{headers:{Authorization:this.$store.state.token}}).then((t=>{"20000"==t.data.code?(this.scoreFormVisible=!0,this.scoreStuForm=t.data.data,o.Z.get(l.Z.baseURL+"/chooseCourse/getCanScoreCourse?stuId="+e.stuId,{headers:{Authorization:this.$store.state.token}}).then((e=>{this.courseNames=e.data.data}))):this.$message.error(t.data.msg)}))},openEditStu(e){o.Z.get(l.Z.baseURL+"/student/getByStuId?stuId="+e.stuId,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code&&(this.editFormVisible=!0,this.editStuForm=e.data.data)}))},editStu(){this.$refs.editStuFormRef.validate((e=>{if(!e)return!1;o.Z.put(l.Z.baseURL+"/student/editByStuId",this.editStuForm,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.editFormVisible=!1,this.clearEditForm(),this.getStuList(),this.$message.success(e.data.msg)):this.$message.error(e.data.msg)}))}))},openAddStu(){this.addFormVisible=!0,o.Z.get(l.Z.baseURL+"/major/getAllMajorName",{headers:{Authorization:this.$store.state.token}}).then((e=>{this.majorNames=e.data.data}))},getStuList(){o.Z.get(l.Z.baseURL+"/student/stuPageList?pageNum="+this.pageNum+"&pageSize="+this.pageSize+"&stuId="+this.stuId+"&stuName="+this.stuName+"&className="+this.className,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.stuList=e.data.data.stuList,this.total=e.data.data.total):this.$message.error(e.data.msg)}))},handleCurrentChange(e){this.pageNum=e,this.getStuList()},handleSizeChange(e){this.pageSize=e,this.pageNum=1,this.getStuList()},clearAddForm(){this.addStuForm={},this.$set(this.addStuForm,"classId",""),this.$refs.addStuFormRef.clearValidate()},clearEditForm(){this.editStuForm={},this.$refs.editStuFormRef.clearValidate()},clearScoreForm(){this.scoreStuForm={},this.$refs.scoreStuFormRef.clearValidate()},addStu(){console.log(this.addStuForm.classId),this.$refs.addStuFormRef.validate((e=>{if(!e)return!1;o.Z.post(l.Z.baseURL+"/student/add",{admissionYear:this.addStuForm.admissionYear,majorName:this.addStuForm.majorName,classId:this.addStuForm.classId,stuName:this.addStuForm.stuName,stuIdCard:this.addStuForm.stuIdCard},{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.addFormVisible=!1,this.clearAddForm(),this.getStuList(),this.$message.success(e.data.msg)):this.$message.error(e.data.msg)}))}))}}},d=i,u=a(3736),m=(0,u.Z)(d,s,r,!1,null,"1d3752b7",null),c=m.exports},7344:function(e,t){const a={assertsSubDirectory:"static",assertsPublicPath:"/",baseURL:"http://118.31.60.230:8091",timeout:2e4,changeOrigin:!0};t["Z"]=a}}]);
//# sourceMappingURL=64.9b8363d8.js.map