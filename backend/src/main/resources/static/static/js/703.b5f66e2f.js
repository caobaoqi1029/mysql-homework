"use strict";(self["webpackChunkstu_score_front"]=self["webpackChunkstu_score_front"]||[]).push([[703],{3703:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var r=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"findAdd"},[e("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入专业名称",clearable:""},model:{value:t.majorName,callback:function(e){t.majorName=e},expression:"majorName"}}),e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchMajorList}},[t._v("搜索")]),e("el-button",{staticStyle:{"margin-left":"0"},attrs:{icon:"el-icon-refresh"},on:{click:t.resetMajorList}},[t._v("刷新")]),e("el-button",{staticStyle:{"margin-left":"560px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.openMajorForm(null)}}},[t._v("新增专业 ")])],1),e("div",{staticClass:"majorTable"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.majorList,stripe:"",size:"small"}},[e("el-table-column",{attrs:{label:"序号",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s((t.pageNum-1)*t.pageSize+e.$index+1)+" ")]}}])}),e("el-table-column",{attrs:{prop:"majorId",label:"专业编号",align:"center",width:"150",sortable:""}}),e("el-table-column",{attrs:{prop:"majorName",label:"专业名称",align:"center",width:"200",sortable:""}}),e("el-table-column",{attrs:{prop:"classTotal",label:"班级数量",align:"center",width:"150",sortable:""}}),e("el-table-column",{attrs:{prop:"courseTotal",label:"课程数量",align:"center",width:"150",sortable:""}}),e("el-table-column",{attrs:{prop:"stuTotal",label:"学生数量",align:"center",width:"150",sortable:""}}),e("el-table-column",{attrs:{prop:"teaTotal",label:"班主任数量",align:"center",width:"150",sortable:""}}),e("el-table-column",{attrs:{prop:"handle",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(e){return t.openMajorForm(a.row)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){return t.delMajor(a.row)}}},[t._v("删除")])]}}])})],1)],1),e("div",{staticClass:"page"},[e("el-pagination",{attrs:{"pager-count":11,background:"","current-page":t.pageNum,"page-size":t.pageSize,"page-sizes":[5,10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),e("div",{staticClass:"MajorDialog"},[e("el-dialog",{attrs:{title:t.title,visible:t.formVisible},on:{close:t.clearForm,"update:visible":function(e){t.formVisible=e}}},[e("el-form",{ref:"majorFormRef",attrs:{model:t.majorForm,rules:t.rules}},[e("el-form-item",{attrs:{label:"专业名","label-width":"150px",prop:"majorName"}},[e("el-input",{attrs:{autocomplete:"off",placeholder:"请输入专业名",clearable:""},model:{value:t.majorForm.majorName,callback:function(e){t.$set(t.majorForm,"majorName",e)},expression:"majorForm.majorName"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){return t.cancelForm(t.title)}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveMajor(t.title)}}},[t._v("确 定")])],1)],1)],1),e("el-backtop",{attrs:{"visibility-height":200}},[e("div",{staticStyle:{"{\n      height":"100%",width:"100%","background-color":"#f2f5f6","box-shadow":"0 0 6px rgba(0,0,0, .30)","text-align":"center","line-height":"40px",color:"#1989fa"}},[t._v(" ↑ ")])])],1)},o=[],s=a(4161),i=a(7344),l={name:"MajorManage",data(){return{majorName:"",majorList:[{majorId:"",majorName:"",classTotal:0,courseTotal:0}],title:"",pageNum:1,pageSize:10,total:0,formVisible:!1,majorForm:{majorId:"",majorName:""},rules:{majorName:[{required:!0,message:"请输入专业",trigger:"blur"},{min:2,max:20,message:"专业名长度为2到20个字符",trigger:"blur"}]}}},methods:{getMajorList(){s.Z.get(i.Z.baseURL+"/major/majorPageList?pageNum="+this.pageNum+"&pageSize="+this.pageSize+"&majorName="+this.majorName,{headers:{Authorization:this.$store.state.token}}).then((t=>{"20000"==t.data.code?(this.majorList=t.data.data.majorList,this.total=t.data.data.total):this.$message.error(t.data.msg)}))},searchMajorList(){this.pageNum=1,this.getMajorList()},resetMajorList(){location.reload()},openMajorForm(t){null==t?(this.formVisible=!0,this.title="新增专业"):t.classTotal>0||t.courseTotal>0?this.$message.info("该专业还有班级或课程，无法编辑"):(this.formVisible=!0,this.title="编辑专业",s.Z.get(i.Z.baseURL+"/major/getByMajorId?majorId="+t.majorId,{headers:{Authorization:this.$store.state.token}}).then((t=>{"20000"==t.data.code?this.majorForm=t.data.data:this.$message.error(t.data.msg)})))},delMajor(t){t.classTotal>0||t.courseTotal>0?this.$message.info("该专业还有班级或课程无法，无法删除"):this.$confirm(`确认删除专业：${t.majorName} ？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((()=>{s.Z["delete"](i.Z.baseURL+"/major/delById?majorId="+t.majorId,{headers:{Authorization:this.$store.state.token}}).then((t=>{"20000"==t.data.code?(this.getMajorList(),this.$message.success(t.data.msg)):this.$message.error(t.data.msg)}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleCurrentChange(t){this.pageNum=t,this.getMajorList()},handleSizeChange(t){this.pageSize=t,this.pageNum=1,this.getMajorList()},clearForm(){this.majorForm={},this.$refs.majorFormRef.clearValidate()},cancelForm(t){this.formVisible=!1,this.clearForm(),"新增专业"==t?this.$message.info("已取消新增"):"编辑专业"==t&&this.$message.info("已取消编辑")},saveMajor(t){this.$refs.majorFormRef.validate((e=>{if(e&&"新增专业"==t)s.Z.post(i.Z.baseURL+"/major/add",{majorName:this.majorForm.majorName},{headers:{Authorization:this.$store.state.token}}).then((t=>{"20000"==t.data.code?(this.formVisible=!1,this.clearForm(),this.getMajorList(),this.$message.success(t.data.msg)):this.$message.error(t.data.msg)}));else{if(!e||"编辑专业"!=t)return!1;s.Z.put(i.Z.baseURL+"/major/edit",{majorName:this.majorForm.majorName,majorId:this.majorForm.majorId},{headers:{Authorization:this.$store.state.token}}).then((t=>{"20000"==t.data.code?(this.formVisible=!1,this.clearForm(),this.getMajorList(),this.$message.success(t.data.msg)):this.$message.error(t.data.msg)}))}}))}},created(){this.getMajorList()}},n=l,m=a(3736),c=(0,m.Z)(n,r,o,!1,null,"7902fc5a",null),h=c.exports},7344:function(t,e){const a={assertsSubDirectory:"static",assertsPublicPath:"/",baseURL:"http://118.31.60.230:8091",timeout:2e4,changeOrigin:!0};e["Z"]=a}}]);
//# sourceMappingURL=703.b5f66e2f.js.map