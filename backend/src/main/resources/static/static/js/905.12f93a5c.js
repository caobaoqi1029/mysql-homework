"use strict";(self["webpackChunkstu_score_front"]=self["webpackChunkstu_score_front"]||[]).push([[905],{6905:function(e,a,t){t.r(a),t.d(a,{default:function(){return u}});var s=function(){var e=this,a=e._self._c;return a("div",[a("div",{staticClass:"findAdd"},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入班级名称",clearable:""},model:{value:e.className,callback:function(a){e.className=a},expression:"className"}}),a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入班主任姓名",clearable:""},model:{value:e.teaName,callback:function(a){e.teaName=a},expression:"teaName"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchClassList}},[e._v("搜索")]),a("el-button",{staticStyle:{"margin-left":"0"},attrs:{icon:"el-icon-refresh"},on:{click:e.resetClassList}},[e._v("刷新")]),a("el-button",{staticStyle:{"margin-left":"240px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(a){return e.openClassForm()}}},[e._v("新增班级 ")])],1),a("div",{staticClass:"classTable"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.classList,stripe:"",size:"small"}},[a("el-table-column",{attrs:{label:"序号",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s((e.pageNum-1)*e.pageSize+a.$index+1)+" ")]}}])}),a("el-table-column",{attrs:{prop:"classId",label:"班级编号",align:"center",width:"150",sortable:""}}),a("el-table-column",{attrs:{prop:"className",label:"班级名称",align:"center",width:"200",sortable:""}}),a("el-table-column",{attrs:{prop:"majorName",label:"所属专业",align:"center",width:"200",sortable:""}}),a("el-table-column",{attrs:{prop:"classYear",label:"年级",align:"center",width:"100",sortable:""}}),a("el-table-column",{attrs:{prop:"stuTotal",label:"学生数量",align:"center",width:"150",sortable:""}}),a("el-table-column",{attrs:{prop:"teaName",label:"班主任姓名",align:"center",width:"150",sortable:""}}),a("el-table-column",{attrs:{prop:"handle",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.delClass(t.row)}}},[e._v("删除")])]}}])})],1)],1),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{"pager-count":11,background:"","current-page":e.pageNum,"page-size":e.pageSize,"page-sizes":[5,10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("div",{staticClass:"classDialog"},[a("el-dialog",{attrs:{title:"新增班级",visible:e.formVisible},on:{close:e.clearForm,"update:visible":function(a){e.formVisible=a}}},[a("el-form",{ref:"classFormRef",attrs:{model:e.classForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"年级","label-width":"150px",prop:"classYear"}},[a("el-select",{attrs:{placeholder:"请选择年级",clearable:""},model:{value:e.classForm.classYear,callback:function(a){e.$set(e.classForm,"classYear",a)},expression:"classForm.classYear"}},e._l(e.classYears,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"专业","label-width":"150px",prop:"majorName"}},[a("el-select",{attrs:{placeholder:"请选择专业",clearable:""},model:{value:e.classForm.majorName,callback:function(a){e.$set(e.classForm,"majorName",a)},expression:"classForm.majorName"}},e._l(e.majorNames,(function(e){return a("el-option",{key:e.majorId,attrs:{label:e.majorName,value:e.majorName}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(a){return e.cancelForm()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.saveClass()}}},[e._v("确 定")])],1)],1)],1),a("el-backtop",{attrs:{"visibility-height":200}},[a("div",{staticStyle:{"{\n      height":"100%",width:"100%","background-color":"#f2f5f6","box-shadow":"0 0 6px rgba(0,0,0, .30)","text-align":"center","line-height":"40px",color:"#1989fa"}},[e._v(" ↑ ")])])],1)},l=[],r=t(4161),i=t(7344),o={name:"ClassManage",data(){let e=new Date,a=e.getFullYear(),t=a-1,s=new Date(a+"-9-01 00:00:00");return e>s&&(t+=1),{className:"",teaName:"",classList:[{classId:"",className:"",majorName:"",stuTotal:0,classYear:""}],pageNum:1,pageSize:20,total:0,formVisible:!1,classForm:{majorName:"",classYear:""},rules:{classYear:{required:!0,message:"请选择年级",trigger:"blur"},majorName:{required:!0,message:"请选择专业",trigger:"blur"}},majorNames:[],classYears:[{value:"1",label:t},{value:"2",label:t-1},{value:"3",label:t-2},{value:"4",label:t-3}]}},methods:{getClassList(){r.Z.get(i.Z.baseURL+"/class/classPageList?pageNum="+this.pageNum+"&pageSize="+this.pageSize+"&className="+this.className+"&teaName="+this.teaName,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.classList=e.data.data.classList,this.total=e.data.data.total):this.$message.error(e.data.msg)}))},searchClassList(){this.pageNum=1,this.getClassList()},resetClassList(){location.reload()},openClassForm(){this.formVisible=!0,r.Z.get(i.Z.baseURL+"/major/getAllMajorName",{headers:{Authorization:this.$store.state.token}}).then((e=>{this.majorNames=e.data.data}))},delClass(e){e.stuTotal>0&&this.$message.info("该班级还有学生，无法删除"),""!=e.teaName&&null!=e.teaName?this.$message.info("该班级还有班主任，无法删除"):this.$confirm(`确认删除班级：${e.className} ？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((()=>{r.Z["delete"](i.Z.baseURL+"/class/delClassById?classId="+e.classId,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.$message.success(e.data.msg),this.getClassList()):this.$message.error(e.data.msg)}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleCurrentChange(e){this.pageNum=e,this.getClassList()},handleSizeChange(e){this.pageSize=e,this.pageNum=1,this.getClassList()},clearForm(){this.classForm={},this.$refs.classFormRef.clearValidate()},cancelForm(){this.formVisible=!1,this.clearForm(),this.$message.info("已取消新增")},saveClass(){this.$refs.classFormRef.validate((e=>{if(!e)return!1;r.Z.post(i.Z.baseURL+"/class/add",{majorName:this.classForm.majorName,classYear:this.classForm.classYear},{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.formVisible=!1,this.clearForm(),this.getClassList(),this.$message.success(e.data.msg)):this.$message.error(e.data.msg)}))}))}},created(){this.getClassList()}},c=o,n=t(3736),m=(0,n.Z)(c,s,l,!1,null,"5eccc258",null),u=m.exports},7344:function(e,a){const t={assertsSubDirectory:"static",assertsPublicPath:"/",baseURL:"http://118.31.60.230:8091",timeout:2e4,changeOrigin:!0};a["Z"]=t}}]);
//# sourceMappingURL=905.12f93a5c.js.map