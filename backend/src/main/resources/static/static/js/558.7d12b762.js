"use strict";(self["webpackChunkstu_score_front"]=self["webpackChunkstu_score_front"]||[]).push([[558],{4558:function(e,a,t){t.r(a),t.d(a,{default:function(){return n}});var s=function(){var e=this,a=e._self._c;return a("div",[a("div",{staticClass:"findAdd"},[a("el-input",{staticStyle:{width:"240px"},attrs:{autocomplete:"off",placeholder:"请输入班主任编号",clearable:""},model:{value:e.teaId,callback:function(a){e.teaId=a},expression:"teaId"}}),a("el-input",{staticStyle:{width:"240px"},attrs:{autocomplete:"off",placeholder:"请输入班主任姓名",clearable:""},model:{value:e.teaName,callback:function(a){e.teaName=a},expression:"teaName"}}),a("el-input",{staticStyle:{width:"240px"},attrs:{autocomplete:"off",placeholder:"请输入班级名称",clearable:""},model:{value:e.className,callback:function(a){e.className=a},expression:"className"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchTeaList}},[e._v("搜索")]),a("el-button",{staticStyle:{"margin-left":"0"},attrs:{icon:"el-icon-refresh"},on:{click:e.resetTeaList}},[e._v("刷新")]),a("el-button",{staticStyle:{"margin-left":"40px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddTea}},[e._v("新增班主任")])],1),a("div",{staticClass:"teaTable"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.teaList,stripe:"",size:"small"}},[a("el-table-column",{attrs:{label:"序号",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s((e.pageNum-1)*e.pageSize+a.$index+1)+" ")]}}])}),a("el-table-column",{attrs:{prop:"teaId",label:"班主任编号",sortable:"",align:"center",width:"150"}}),a("el-table-column",{attrs:{prop:"teaName",label:"班主任姓名",align:"center",sortable:"",width:"150"}}),a("el-table-column",{attrs:{prop:"majorName",sortable:"",align:"center",width:"200",label:"专业名称"}}),a("el-table-column",{attrs:{prop:"className",align:"center",width:"200",label:"班级名称",sortable:""}}),a("el-table-column",{attrs:{prop:"classYear",align:"center",width:"150",label:"年级",sortable:""}}),a("el-table-column",{attrs:{prop:"handle",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(a){return e.openEditTea(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.delTea(t.row)}}},[e._v("删除")])]}}])})],1)],1),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{"pager-count":11,background:"","current-page":e.pageNum,"page-size":e.pageSize,"page-sizes":[5,10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("div",{staticClass:"addTeaDialog"},[a("el-dialog",{attrs:{title:"新增班主任",visible:e.addFormVisible},on:{close:e.clearAddForm,"update:visible":function(a){e.addFormVisible=a}}},[a("el-form",{ref:"addTeaFormRef",attrs:{model:e.addTeaForm,rules:e.addRules}},[a("el-form-item",{attrs:{label:"年级","label-width":"150px",prop:"classYear"}},[a("el-select",{attrs:{placeholder:"请选择年级",clearable:""},on:{change:function(a){return e.getClasses(e.addTeaForm)}},model:{value:e.addTeaForm.classYear,callback:function(a){e.$set(e.addTeaForm,"classYear",a)},expression:"addTeaForm.classYear"}},e._l(e.classYears,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"专业","label-width":"150px",prop:"majorName"}},[a("el-select",{attrs:{placeholder:"请选择专业",clearable:""},on:{change:function(a){return e.getClasses(e.addTeaForm)}},model:{value:e.addTeaForm.majorName,callback:function(a){e.$set(e.addTeaForm,"majorName",a)},expression:"addTeaForm.majorName"}},e._l(e.majorNames,(function(e){return a("el-option",{key:e.majorId,attrs:{label:e.majorName,value:e.majorName}})})),1)],1),a("el-form-item",{attrs:{label:"班号","label-width":"150px",prop:"classId"}},[a("el-select",{attrs:{placeholder:"请选择班号",clearable:"",id:"selectClassId"},model:{value:e.addTeaForm.classId,callback:function(a){e.$set(e.addTeaForm,"classId",a)},expression:"addTeaForm.classId"}},e._l(e.classNos,(function(e){return a("el-option",{key:e.classId,attrs:{label:e.classId.substring(6,7),value:e.classId}})})),1)],1),a("el-form-item",{attrs:{label:"班主任姓名","label-width":"150px",prop:"teaName"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入班主任姓名",clearable:""},model:{value:e.addTeaForm.teaName,callback:function(a){e.$set(e.addTeaForm,"teaName",a)},expression:"addTeaForm.teaName"}})],1),a("el-form-item",{attrs:{label:"身份证","label-width":"150px",prop:"teaIdCard"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入身份证",clearable:""},model:{value:e.addTeaForm.teaIdCard,callback:function(a){e.$set(e.addTeaForm,"teaIdCard",a)},expression:"addTeaForm.teaIdCard"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelAdd}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addTea}},[e._v("确 定")])],1)],1)],1),a("div",{staticClass:"editStuDialog"},[a("el-dialog",{attrs:{title:"编辑班主任",visible:e.editFormVisible},on:{close:e.clearEditForm,"update:visible":function(a){e.editFormVisible=a}}},[a("el-form",{ref:"editTeaFormRef",attrs:{model:e.editTeaForm,rules:e.editRules}},[a("el-form-item",{attrs:{label:"年级","label-width":"150px",prop:"classYear",disabled:""}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入专业",disabled:""},model:{value:e.editTeaForm.classYear,callback:function(a){e.$set(e.editTeaForm,"classYear",a)},expression:"editTeaForm.classYear"}})],1),a("el-form-item",{attrs:{label:"专业","label-width":"150px",prop:"majorName"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入专业",disabled:""},model:{value:e.editTeaForm.majorName,callback:function(a){e.$set(e.editTeaForm,"majorName",a)},expression:"editTeaForm.majorName"}})],1),a("el-form-item",{attrs:{label:"班号","label-width":"150px",prop:"classNo"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入班号",disabled:""},model:{value:e.editTeaForm.classNo,callback:function(a){e.$set(e.editTeaForm,"classNo",a)},expression:"editTeaForm.classNo"}})],1),a("el-form-item",{attrs:{label:"班主任姓名","label-width":"150px",prop:"teaName"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入班主任姓名",clearable:""},model:{value:e.editTeaForm.teaName,callback:function(a){e.$set(e.editTeaForm,"teaName",a)},expression:"editTeaForm.teaName"}})],1),a("el-form-item",{attrs:{label:"身份证","label-width":"150px",prop:"teaIdCard"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入身份证",disabled:""},model:{value:e.editTeaForm.teaIdCard,callback:function(a){e.$set(e.editTeaForm,"teaIdCard",a)},expression:"editTeaForm.teaIdCard"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelEdit}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.editTea}},[e._v("确 定")])],1)],1)],1),a("el-backtop",{attrs:{"visibility-height":200}},[a("div",{staticStyle:{"{\n      height":"100%",width:"100%","background-color":"#f2f5f6","box-shadow":"0 0 6px rgba(0,0,0, .30)","text-align":"center","line-height":"40px",color:"#1989fa"}},[e._v(" ↑ ")])])],1)},l=[],r=t(4161),o=t(7344),i={name:"AddTea",data(){let e=new Date,a=e.getFullYear(),t=a-1,s=new Date(a+"-9-01 00:00:00");e>s&&(t+=1);let l=(e,a,t)=>{let s=/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|[xX])$/;if(!s.test(a))return t(new Error("身份证格式错误"));t()};return{teaId:"",teaName:"",className:"",majorName:"",classNo:"",pageNum:1,pageSize:20,total:0,teaList:[{teaId:"",teaName:"",majorName:"",classNo:""}],addFormVisible:!1,editFormVisible:!1,addTeaForm:{teaIdCard:"",majorName:"",teaName:"",classId:""},editTeaForm:{teaIdCard:"",majorName:"",teaName:""},majorNames:[],classNos:[],addRules:{classYear:{required:!0,message:"请选择年级",trigger:"blur"},majorName:{required:!0,message:"请选择专业",trigger:"blur"},classId:{required:!0,message:"请选择班号",trigger:"blur"},teaName:[{required:!0,message:"请输入班主任姓名",trigger:"blur"},{min:2,max:20,message:"姓名长度为2到20个字符",trigger:"blur"}],teaIdCard:[{required:!0,message:"请输入身份证",trigger:"blur"},{validator:l,trigger:"blur"}]},editRules:{teaName:[{required:!0,message:"请输入班主任姓名",trigger:"blur"},{min:2,max:20,message:"姓名长度为2到20个字符",trigger:"blur"}]},classYears:[{value:"1",label:t},{value:"2",label:t-1},{value:"3",label:t-2},{value:"4",label:t-3}]}},methods:{getClasses(e){this.$set(this.addTeaForm,"classId",""),""!=e.majorName&&void 0!=e.majorName&&""!=e.classYear&&void 0!=e.classYear&&r.Z.get(o.Z.baseURL+"/class/getClassesByMajorName?majorName="+e.majorName+"&classYear="+e.classYear,{headers:{Authorization:this.$store.state.token}}).then((e=>{(e.code="20000")&&(this.classNos=e.data.data)}))},getTeaList(){r.Z.get(o.Z.baseURL+"/teacher/teaPageList?pageNum="+this.pageNum+"&pageSize="+this.pageSize+"&teaId="+this.teaId+"&teaName="+this.teaName+"&className="+this.className,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.teaList=e.data.data.teaList,this.total=e.data.data.total):this.$message.error(e.data.msg)}))},resetTeaList(){location.reload()},searchTeaList(){this.pageNum=1,this.getTeaList()},openAddTea(){this.addFormVisible=!0,r.Z.get(o.Z.baseURL+"/major/getAllMajorName",{headers:{Authorization:this.$store.state.token}}).then((e=>{this.majorNames=e.data.data}))},openEditTea(e){r.Z.get(o.Z.baseURL+"/teacher/getTeaById?teaId="+e.teaId,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.editFormVisible=!0,this.editTeaForm=e.data.data):this.$message.error(e.data.msg)}))},handleCurrentChange(e){this.pageNum=e,this.getTeaList()},handleSizeChange(e){this.pageSize=e,this.pageNum=1,this.getTeaList()},clearAddForm(){this.addTeaForm={},this.$refs.addTeaFormRef.clearValidate()},clearEditForm(){this.editTeaForm={},this.$refs.editTeaFormRef.clearValidate()},cancelAdd(){this.addFormVisible=!1,this.classNos=[],this.clearAddForm(),this.$set(this.addTeaForm,"classId",""),this.$message.info("已取消新增")},cancelEdit(){this.editFormVisible=!1,this.clearEditForm(),this.$message.info("已取消编辑")},addTea(){this.$refs.addTeaFormRef.validate((e=>{if(!e)return!1;r.Z.post(o.Z.baseURL+"/teacher/add",{classYear:this.addTeaForm.classYear,majorName:this.addTeaForm.majorName,classId:this.addTeaForm.classId,teaName:this.addTeaForm.teaName,teaIdCard:this.addTeaForm.teaIdCard},{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.addFormVisible=!1,this.clearAddForm(),this.getTeaList(),this.$message.success(e.data.msg)):this.$message.error(e.data.msg)}))}))},delTea(e){this.$confirm(`确认删除班主任：${e.teaName} ？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((()=>{r.Z["delete"](o.Z.baseURL+"/teacher/delTea?teaId="+e.teaId,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.getTeaList(),this.$message.success(e.data.msg)):this.$message.error(e.data.msg)}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},editTea(){this.$refs.editTeaFormRef.validate((e=>{if(!e)return!1;r.Z.put(o.Z.baseURL+"/teacher/editById",this.editTeaForm,{headers:{Authorization:this.$store.state.token}}).then((e=>{"20000"==e.data.code?(this.editFormVisible=!1,this.clearEditForm(),this.getTeaList(),this.$message.success(e.data.msg)):this.$message.error(e.data.msg)}))}))}},created(){this.searchTeaList()}},d=i,c=t(3736),m=(0,c.Z)(d,s,l,!1,null,"7577235b",null),n=m.exports},7344:function(e,a){const t={assertsSubDirectory:"static",assertsPublicPath:"/",baseURL:"http://118.31.60.230:8091",timeout:2e4,changeOrigin:!0};a["Z"]=t}}]);
//# sourceMappingURL=558.7d12b762.js.map