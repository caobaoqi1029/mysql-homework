---
title: 关系模型及关系代数
order: 3
icon: /mysql-item.svg
category:
  - BOOK
  - MD
---

关系数据库是以关系模型为基础的数据库类型，它是目前各类数据库中最重要、最流行的一种。关系数据库采用数学方法来处理数据库数据，并且是目前使用最广泛的数据库系统之一。

在1970年，IBM公司的研究员E.F. Codd博士发表了一篇名为“大型共享数据库的关系模型”的论文，其中首次提出了关系模型的概念。随后，他又发表了多篇文章，提出了关系代数和关系演算的概念，并于1972年提出了第一范式、第二范式等关系模型的规范化理论，进一步对关系模型的概念进行了完善。

关系模型是一种基于表格的数据结构，它将数据组织成行和列的形式，每一行代表一条记录，每一列代表一种属性。通过这种方式，可以方便地存储和管理大量的数据，并且支持高效的数据查询和更新操作。

关系数据库的优点包括易于使用、可靠性高、可扩展性强、数据一致性好等。因此，在商业、科研等领域广泛应用。同时，由于其开放性和标准化的特点，也使得关系数据库成为了互联网时代最重要的基础技术之一。

## 一、关系模型三要素

关系模型是一种常见的数据库模型，它相比非关系模型最大的优点在于其数据结构单一。在关系模型中，所有的数据都以关系的形式存在，而实体集和实体集之间的联系也都是通过关系来表示的。这种单一的数据结构使得关系模型的操作方法非常统一，易于用户掌握和理解。

关系操作采用集合操作的方式，即操作对象和结果都是集合。这种操作方式被称为“一次一集合”，与非关系模型的一次一记录的数据操作方式不同。关系模型提供了强大的关系操作能力，包括并、交、差、广义笛卡尔积、选择、投影、连接、除等查询操作以及添加、删除、修改等更新操作。其中，查询的表达能力是关系模型最主要的部分。

此外，关系模型还提供了丰富的完整性控制机制，允许定义三种完整性约束：实体完整性、参照完整性和用户自定义完整性。实体完整性和参照完整性分别对应于关系的主码和外码，并由DBMS自动完成约束机制的实现。用户自定义完整性则是应用领域需要遵循的约束条件，体现了具体领域中的语义约束。

总之，关系模型具有简单明了的数据结构、统一的操作方法、强大的查询能力和丰富的完整性控制机制等优点，因此被广泛应用于各种类型的数据库系统中。

### 1.1 关系数据结构

### - 关系的相关名词


关系是指一张由多个列组成的二维表格，其中每一行代表一条记录，每列表示一种属性。这个二维表格可以用来描述实体之间的联系、数据之间的关联等信息。

而元组则是指在关系模型中，每一个包含有若干个属性值的数据集合。每个元组都对应着关系模型中的一条记录，即一个具体的数据实例。例如，在学生关系模型中，每个学生的姓名、学号、性别、年龄等信息都可以作为一个元组来表示。


属性（attribute）是关系模型中的一个重要概念。它指的是关系模型中的每一列，也就是关系中的每一个特征。每个属性都有自己的名称和类型，并且可以拥有不同的值。

在关系模型中，属性的数量被称为关系的“目”（attribute），也可以称为“元”（attribute）。例如，如果一个关系中有5个属性，则称其为五目关系或五元关系。

属性通常有两种含义：一是它的类型，即这个属性所代表的数据类型；二是它的值，即这个属性的具体取值。属性的类型决定了它可以存储哪些类型的值，而属性的值则决定了具体的记录内容。

在关系模型中，属性的选择非常重要。因为属性的选择会直接影响到关系模型的质量和性能。一个好的属性集合应该满足以下几个条件：

1. 具有足够的信息量，能够描述出关系模型的本质特征；
2. 具有一定的独立性，即不与其他属性高度相关；
3. 具有较小的冗余度，避免重复存储相同的


在关系型数据库中，每个表都有一个唯一的标识符，称为主键。主键是一个或多列的组合，它们能够唯一地标识表中的每一行记录。这些能够唯一标识一行记录的列被称为候选键。

在上面的例子中，学生表有两个候选键：“学号”和“姓名”。由于学生的姓名可能会重复，因此我们选择了“学号”作为学生表的主键。这样，在插入或查询学生信息时，我们可以使用学号来确保每条记录都是唯一的。

主键的作用是在表之间建立关联，并且保证数据的完整性。在一个表中，主键必须是唯一的，不能为空，并且不能被修改。如果尝试插入与已有记录相同的主键，则会出现错误。此外，主键还可以用于加速查询操作，因为数据库系统可以通过主键快速定位到特定的记录。

总之，候选键是指能够唯一标识一条记录的一列或多列，而主键是从候选键中选择的一个列或一组列，用于唯一标识表中的每一行记录并维护数据的完整性。


主属性和非主属性是指在一个关系模型中，如果某个属性包含了关系模型的所有数据，则该属性被称为主属性。而如果不包含在任何一个候选码中的属性则被称为非主属性。

例如，在学生关系模型中，如果有两个候选码“学号”和“姓名”，那么这两个属性就是主属性，因为它们包含了所有学生的相关信息。而其他属性如“性别”、“年龄”和“专业”则是非主属性，因为它们不包含所有学生的信息。

主属性和非主属性的区别在于它们是否能够唯一地标识一条记录。在关系模型中，如果一个属性可以唯一地标识一条记录，则它是一个候选码，同时也是一条记录的主键。而如果一个属性不能唯一地标识一条记录，则它不是候选码，也不是主键。

因此，在设计关系模型时，需要考虑哪些属性作为主属性，以便能够唯一地标识每一条记录，并且保证数据的一致性和完整性。同时，也需要考虑哪些属性是非主属性，以便能够存储更多的信息，并且避免冗余数据的出现。

### - 关系的数学定义

关系模型是一种基于关系代数和集合论等数学理论的数据模型。它通过将数据组织成表格的形式来表示信息，并使用关系运算符（如选择、投影、连接等）来操作这些表格。

在关系模型中，域是指一组具有相同数据类型的值的集合。例如，整数、实数、介于某个取值范围的整数以及字符集都可以作为域。而笛卡尔积则是指给定一组域D1, D2, ..., Dn，它们的笛卡尔积为{(d1, d2, ..., dn) | dieDi, i=1, 2, ..., n}，即所有域的所有取值的一个组合，其中每个元素都不能重复。

通过使用关系模型，我们可以方便地存储和管理大量的数据，并且可以通过各种关系运算符来进行高效的数据查询和处理。同时，关系模型也是现代数据库系统中最常用的一种数据模型之一。

关系是指在不同领域（如数据库、数学等）中所描述的一种关联性。它是由多个域组成的笛卡尔积的有限子集，在这些领域中通常以形式化的表达方式进行描述，例如 R(D1, D2, ..., Dn)，其中R是关系名，n是关系的目或度数，而D1、D2、...、Dn则是构成关系的不同域。

### - 关系的限定


在关系数据库中，关系是指由若干个属性值组成的集合。关系中的每个属性值都称为分量，而关系中的所有分量组成了该关系的所有数据。

关系中每个分量必须取原子值，这是关系最基本的要求之一。原子值指的是不可再分的数据项，比如数字、字符串等。如果关系中的某个分量不是原子值，那么这个关系就不能被称为关系了。

此外，关系中每个分量都是不可再分的数据项，这也是关系最基本的规范化要求之一。这意味着，在关系中，同一个属性的值应该是相同的类型，并且不能再被拆分成更小的部分。这样可以保证关系的一致性和完整性，使得数据更加可靠和易于管理。

总之，关系数据库中的关系需要满足基本的规范要求，其中关系中每个分量必须取原子值，每个分量都是不可再分的数据项，这是关系最基本的要求之一。这些要求确保了关系的一致性、完整性和可靠性，使得关系数据库能够更好地管理和处理数据。


在数据库设计中，数据表中的每一列都对应着一个特定的数据类型，比如整数、字符串、日期等。而关系模型要求同一列的数据应该具有相同的数据类型，这就是所谓的“同质性”。也就是说，在同一个关系中，如果某一列存储的是数值型数据，则该列的所有值都应该属于数值型数据；如果某一列存储的是字符型数据，则该列的所有值都应该属于字符型数据。

这种同质性的要求是为了保证数据的一致性和准确性。如果不同列的数据类型不一致，就会导致数据无法正确地比较和计算，从而影响到整个系统的正常运行。因此，在设计数据库时，需要仔细考虑每个属性的数据类型，并确保它们都是同质的，这样才能有效地管理和利用数据资源。


在关系模型中，每个属性都是由其名称和数据类型组成的。因此，在定义关系时，需要为每个属性指定唯一的名称，以避免出现重复的属性名。

虽然不同的属性可以来自同一个域，即它们的数据类型相同，但是为了保证关系的唯一性，必须为每个属性指定不同的名称。例如，在一个存储学生信息的关系中，如果有两个属性分别为“姓名”和“姓名”，那么这个关系就无法正确地表示学生的不同信息，因为这两个属性具有相同的名称，无法区分它们所代表的不同含义。

因此，在设计关系时，应该遵循这个规则，确保每个属性都有唯一的名称，并且这些名称能够清晰地表达该属性所代表的信息。这样才能够有效地组织和管理数据，提高数据的可读性和可维护性。

在关系型数据库中，每个表都有多个属性（也称为字段），用于描述该表所包含的数据。这些属性可以来自同一个数据类型或域，但是它们必须具有不同的名称，以便区分它们所表示的不同信息。

例如，在一个存储学生考试成绩的关系中，我们可以定义一个名为“成绩”的表，其中包含四个属性：学号、课程号、数据库分数和操作系统分数。这四个属性分别用于标识学生的唯一性、课程的唯一性以及学生在该课程中获得的数据库和操作系统分数。

虽然这两个分数属性都可以使用相同的数值范围（即 0 到 100 之间的整数），但是为了使表格更加清晰易懂，我们需要为它们分配不同的属性名称，以避免混淆。因此，“数据库分数”和“操作系统分数”这两个属性应该被赋予不同的名称，而不是简单地将它们都命名为“分数”。

总之，在设计关系型数据库时，我们需要确保每个属性都具有唯一的名称，并且应该尽可能明确地描述其所代表的信息。这样可以使数据更易于理解和管理，并提高查询效率。


在关系数据库中，元组是指表中的一行数据。每个元组都包含该行所对应的记录的所有信息。而关系则是指由若干个属性组成的集合，其中每个属性都是某个值或值的组合。

根据上述内容，我们可以得出结论：关系中不能有两个完全相同的元组。这是因为如果关系中有两个完全相同的元组，那么就相当于现实世界中存在两个完全相同的实体，这与实体的定义中“能相互区分”的特征是矛盾的。

因此，在设计关系数据库时，必须确保每个元组都是唯一的，并且能够正确地反映现实世界中的实体及其属性。这样才能保证关系数据库的有效性和可靠性。


在关系模型中，元组和列的位置具有顺序无关性。这意味着行与行、列与列之间的顺序可以任意交换，而不会影响对关系进行任何操作的结果。

具体来说，关系中的每一行代表了一个实体，每一列则代表了该实体的一个属性或特征。这些行和列的位置是相对的，而不是绝对的。因此，在进行关系操作时，我们可以随意改变行和列的顺序，而不必担心结果会受到影响。

例如，如果我们有一个包含学生姓名、年龄和成绩的关系表，那么我们可以在不改变其含义的情况下，将学生姓名放在第一列，年龄放在第二列，成绩放在第三列，或者反过来。无论哪种排列方式，都不会影响我们对学生信息进行查询、排序、过滤等操作的结果。

总之，关系中的元组和列的位置具有顺序无关性，这使得我们可以更加灵活地组织和处理数据，提高了关系模型的实用性和适应性。

### - 关系模式和关系


关系模式是对关系型数据的描述，反映了关系的结构和框架。关系是由多个元组组成的集合，因此关系模式应该指明这些元组的结构，即它们包含哪些属性、这些属性来自于哪些域以及属性之间的数据依赖关系。

通常情况下，关系模式可以简记为：R(A1, A2, ..., An)，其中R是关系的名称，A1到An是关系的若干个属性。关系模式主要用来描述关系的静态结构，即关系的模式或结构是一旦定义好了就很难再做改变的。而关系的数据则是动态的，它反映了关系在某个特定时间点上的状态，并且随着数据库的使用过程中的更新操作，关系中的数据也会随之实时变化。

总之，关系模式是用来描述关系的基本结构和框架，它是相对稳定的，而关系的数据则是动态的，会随着数据库的使用过程中的更新操作而实时变化。

### 1.2 关系数据操作

在非关系模型中，各个数据记录之间是通过指针等方式连接的，当要定位到某条记录时，需要用户知道数据之间是如何构造指针链接的，然后自己按照指针的链接方向遍历查找，我们称这种查找为用户“导航”。而在关系模型中，由于是按集合进行操作，因此用户只需要指定数据的定位条件，数据库管理系统就可以自动定位到该数据记录，而不需要用户来导航，数据的存取细节对用户透明，大大降低了用户访问数据的复杂度，也减轻了编写程序的工作量。

简单来说，非关系模型需要用户手动导航去查找数据，而关系模型则可以自动定位到所需的数据，让用户更加方便快捷地访问数据。这使得关系模型在实际应用中更为常见和流行。

### 1.3 关系完整性约束

一个好的数据库系统需要一个好的数据库设计，而数据库完整性设计作为数据库设计的一个重要组成部分，直接影响到数据库系统能否真实地反映现实世界。关系模型数据完整性约束体现在以下两个方面：

首先，保证了数据的正确性和相容性。例如，在学生关系中，学号必须是长度为11位的字符串；在课程关系中，开课学院必须是学校已经成立的一个学院；而在选课关系中，学号的值必须是学生关系中已经存在的某位学生的学号，课程号的值必须是课程关系中已经开设的某门课程的课程号。这些数据内部或数据之间的完整性要求均反映了客观环境的业务规则。

其次，有两种实现数据完整性约束的机制。数据完整性约束可以通过DBMS或应用程序来实现。基于DBMS的完整性约束作为模式的一部分存入数据库中，按照数据库设计的步骤进行设计。基于应用程序的完整性约束则通过应用软件编程实现。相比应用程序本身来实现这些完整性规则，利用DBMS的完整性控制机制能简化程序的编写、提高程序的运行效率。

因此，数据库完整性设计对于数据库系统的正确性和可靠性至关重要，只有合理的数据库设计才能确保数据库系统能够真实地反映现实世界的数据情况，并且有效地保障数据的完整性和一致性。

## 二、关系模型的三类完整性约束

### 2.1 实体完整性

关系的实体完整性规则是指在关系模型中，若某个属性是关系的主键，则该属性的取值不能为空。例如，在学生课程数据库中的学生关系中，“学号”是该关系的主键，因此“学号”的值不能为空。同样地，在班级中的“班级编号”和课程中的“课程编号”也不能为空。

需要注意的是，如果主键由多个属性组成，则每个属性都不能为空，而不仅仅是整个主键不能为空。例如，在选课关系中，该关系的主键是由“学号”和“课程编号”组成的，因此“学号”和“课程编号”都不能为空。

实体完整性规则是为了保证数据的一致性和准确性而设置的，它要求每个记录都有唯一的标识符，并且该标识符不能重复或为空。这样可以避免数据冗余和不一致性的问题，同时也可以提高查询效率和数据管理的可靠性。


实体完整性规则是一种数据库约束条件，用于确保关系型数据库中每个实体（或记录）都是唯一的。它基于现实世界的实体本身具有的两个特性：可区分性和唯一性。

实体完整性规则适用于基本关系模型，其中每个关系对应于现实世界的一个实体集，而关系中的每个元组则对应于该实体集中的一个实体。关系的码（或主键）保证了元组的唯一性，从而也保证了实体的唯一性。

此外，空值在实体完整性规则中也被视为一种特殊情况。空值表示“不知道”或“无意义”的数据，而主属性中的空值意味着存在无法识别的实体，也就是不可区分的实体。这与实体可区分性的特性相矛盾，因此实体完整性规则旨在确保实体的可区分性。

总之，实体完整性规则的主要目的是确保关系型数据库中的每个实体都是唯一的，并且具有可区分性。这是通过关系的码来实现的，同时也要注意空值的情况，以避免出现不可区分的实体。

### 2.2 参照完整性

### - 关系间的引用


在关系模型中，关系对应着现实世界中的实体集及其之间的联系。因此，在关系数据之间经常会存在相互引用的情况。例如，在示例3-2中，学生关系和班级关系之间就存在着数据的引用。具体来说，学生关系中的“班级”属性值需要引用班级关系中的“班级编号”的值。

此外，选课关系和学生关系之间以及选课关系和课程关系之间也存在着引用。在选课关系中，“学号”和“课程编号”的值分别需要引用学生关系中的“学号”和课程关系中的“课程编号”的值。

需要注意的是，关系的引用不仅限于不同关系之间，也可能在同一关系内部发生。例如，在示例3-2中，课程关系中的“先修课”值需要引用该关系中的“课程编号”的值。

总之，在关系模型中，关系数据之间的相互引用是非常常见的，并且这种引用可以发生在不同关系之间或同一关系内部。

### - 外码

在数据库设计中，通常会涉及到多个表之间的关联。其中，外键（Foreign Key）是一个非常重要的概念。

假设有一个基本关系 R，它包含若干个属性 F，但是并不是 R 的码。如果 F 与另一个基本关系 S 的主码 Ks 相对应，那么 F 就被称为 R 的外码（Foreign Key）。此时，R 称为参照关系（Referencing Relation），S 称为被参照关系（Referenced Relation）。

例如，在一个学校管理系统中，我们有三个关系：学生关系、班级关系和选课关系。学生关系包含学生的姓名、性别、年龄等信息；班级关系包含班级的编号、名称、所属院系等信息；选课关系则记录了每个学生所选的课程及其成绩。这三个关系之间存在着多对多的关系，即一个学生可以选多门课程，一个班级也可以有多名学生。

在这个例子中，我们可以将学生关系的“班级”作为外码，与班级关系的“班级编号”相对应。这样，我们就可以通过外码来实现对学生所在班级的查询。同样地，选课关系的“学号”和“课程编号”也是外码，分别与学生关系的“学号”和课程关系的“课程编号”相对应。

需要注意的是，外码并不一定和主码同名，它们只需要来自同一个域即可。此外，为了更好地表达外码的含义，我们还可以在外码前面加上“FK_”前缀，以示区别。

### - 参照完整性

如果一个关系的外码包含在本关系的主码中时，说明外码的属性是主属性。在这种情况下，根据实体完整性规则，外码的值不能为空。

因此，在关系数据库设计中，当定义两个关系之间的联系时，需要确定其中一个关系作为另一个关系的外码，并且这两个关系之间存在对应的关系。外码可以是一个单独的属性或者一组属性，它们必须与另一个关系的主码相对应。

例如，在学生关系中，“班级”是一个外码，它与班级关系的主码相对应。因此，“班级”属性的值要么为空值，表示该学生可能是尚未分配班级的转学新生，要么为班级关系中某个已经存在的班级的编号。同样地，“先修课”是课程关系的外码，它与课程关系的主码相对应。因此，“先修课”属性的值要么为空值，表示学习这门课程之前不需要其他前导课程，要么为该关系中已经存在的某门课程的课程编号。

需要注意的是，如果一个关系的外码包含在本关系的主码中时，说明外码的属性是主属性。这种情况下，根据实体完整性规则，外码的值不能为空。这是因为主键的值必须唯一标识每个记录，而外键是用来关联两个表之间的数据的，因此外键的值也必须唯一标识每个记录。

### 2.3 用户自定义完整性


实体完整性和参照完整性约束是数据库管理系统（DBMS）自动支持的关系模型的基本要求。这意味着在设计和管理数据库时，需要确保每个表都有主键，并且所有引用其他表的外键都存在于该表中。

除了这些基本要求之外，不同的应用环境可能会对数据有一些特定的限制条件。例如，在处理个人信息时，可能需要确保年龄的值在16到25岁之间，性别只能是男性或女性等。这些限制条件可以通过使用触发器、存储过程或其他方法来实现。

总之，实体完整性和参照完整性约束是保证数据库结构正确性的重要手段，而特定的应用场景下还需要根据实际需求添加相应的限制条件以保证数据的有效性和安全性。

## 三、关系数据语言

关系操作是指在数据库管理系统中对数据进行管理和处理的操作。其中，数据查询、数据维护和数据控制是关系操作的三大功能。

数据查询指的是对数据库中的数据进行检索、统计、排序等操作，以满足用户的访问需求。常用的数据查询操作有选择（Select）、投影（Project）、连接（Join）、除（Divide）、并（Union）、交（Intersection）、差（Difference）和广义笛卡尔积（Extended Cartesian Product）等。

数据维护则是指对数据库中的数据进行添加、删除、修改等操作，以保持数据的准确性和完整性。常用的数据维护操作有插入（Insert）、删除（Delete）和修改（Update）等。

数据控制则是为了保证数据的安全性和完整性而采取的一系列措施，如并发控制和存取控制等。

关系数据语言可以分为三类：关系代数、关系演算和基于映像的语言。这三种语言都具有完备的表达能力和高度非过程化的特性，并且既可以独立使用也可以嵌入到某种高级语言中。这些语言的主要作用是在数据库管理系统中执行各种关系操作，从而实现对数据的有效管理。

### 3.1 关系代数和关系演算语言


早期的关系操作能力通常使用代数方式和逻辑方式来表示。其中，关系代数是一种纯理论语言，它定义了一些操作，可以通过运用这些操作从一个或多个关系中得到另一个关系，而不改变源关系。关系代数的操作数和操作结果都是关系，并且一个操作的输出可以是另一个操作的输入。关系代数同算数运算一样，可以出现一个套一个的表达式。关系在关系代数下是封闭的，正如数字在算数操作中是封闭的一样。

另一方面，关系演算语言则是用逻辑方法来表达查询要求的语言。根据谓词变元的基本对象是元组变量还是域变量，关系演算语言可以分为元组关系演算语言和域关系演算语言两种。这三种语言在表达能力上完全等价，它们提供了研究关系数据语言的数学工具——集合运算和谓词运算，从理论上建立了一整套完善的关系操作运算规范和语法体系，为其他实际的关系数据语言（如SQL）的发展奠定了坚实的理论基础。

### 3.2 SQL 语言


SQL（Structured Query Language）是一种基于映像的语言，它具有关系代数和关系演算的特性。SQL包括数据定义、数据操纵和数据控制三种功能，具有语言简单、易学易用的特点。它是关系数据库的标准语言，在第4章中将详细介绍其功能语法结构。

SQL是一种用于管理关系型数据库的编程语言，它可以用来创建、修改和查询数据库中的数据。SQL支持多种操作，包括插入、更新、删除和查询等。使用SQL可以轻松地管理和维护数据库，并且可以在不同的平台上运行。

SQL的优点之一是它的易学易用性。相对于其他编程语言，SQL的学习曲线较为平缓，即使是没有编程经验的人也可以很快上手。此外，SQL还具有良好的可读性和可维护性，使得开发人员可以更轻松地理解和修改代码。

总之，SQL作为一种标准的关系数据库语言，具有广泛的应用前景和发展空间。熟练掌握SQL可以帮助开发人员更好地管理和维护数据库，提高工作效率和质量。

## 四、关系的运算


任何一种运算都需要三个基本元素：运算对象、运算符和运算结果。在关系运算中，运算对象是关系，而运算结果同样是关系。关系运算可以分为传统的集合运算和专门的关系运算两种。

传统的集合运算主要考虑行的因素，它将关系看作元组的集合，并且只从行的角度进行运算。这些运算包括并（∪）、交（∩）、差（－）和广义笛卡尔积（×）。其中并运算指的是两个关系中共有的元组被合并；交运算指的是两个关系中都存在的元组；差运算指的是在一个关系中存在而在另一个关系中不存在的元组；广义笛卡尔积则是指将两个关系中的元组按照一定规则组合起来形成新的元组。

专门的关系运算不仅从行的角度进行运算，还从列的角度进行运算。这类运算包括选择（σ）、投影（π）、连接（×）和除（÷）。选择运算是基于某个条件来筛选出符合条件的元组；投影则是从关系中选取某些属性组成新的关系；连接则是在两个关系之间建立关联，得到一个新的关系；除运算则是用于去除重复元组的操作。

总之，关系运算是一种非常重要的数据处理方式，在数据库设计与管理中有着广泛的应用。掌握好关系运算的相关概念和操作方法对于理解和应用关系型数据库非常重要。


在关系运算的数学表达形式中，有一些符号需要进行说明。其中，“t e R”表示“t”是关系“R”的一个元组；而“t[Ai]”则表示元组“t”中相应于属性“Ai”的一个分量。

另外，“t r ∧ t s”被称为元组的连接，即将关系“R”（目为m）中的一个元组“t r”和关系“S”（目为n）中的一个元组“t s”连接成一个m+n列的元组。

此外，“A”是关系“R”中的属性列，则“t[A]”表示元组“t”在属性列“A”上的诸分量的集合。

最后，当给定一个关系“R(X, Z)”且“X”和“Z”为属性组时，如果“t[X] = x”，那么“x”在“R”中的象集（Image Set）为：“Zx={t[Z]|t∈R, t[X]=x}”。它表示“R”中属性组“X”上值为“x”的诸元组在“Z”上分量的集合。

### 4.1 关系代数运算符


关系代数是一种用于处理关系数据库中数据的操作语言。它包含四种类型的运算符，分别是传统的集合运算符、专门的关系运算符、比较运算符和逻辑运算符。

其中，传统的集合运算符包括并（∪）、交（∩）、差（－）和广义笛卡尔积（×），它们可以用来操作关系表之间的集合关系。

专门的关系运算符则包括选择（σ）、投影（π）、连接（）和除（÷）。选择运算符可以根据指定条件从关系表中选取符合条件的数据；投影运算符可以从关系表中选取特定的属性列；连接运算符可以将两个或多个关系表按照指定的条件进行关联；除运算符可以删除关系表中的重复记录。

比较运算符包括大于（>）、大于等于（≥）、小于（<）、小于等于（≤）、等于（=）和不等于（≠），它们可以用来比较两个数值型数据的大小或者相等性。

最后，逻辑运算符包括非（NOT）、与（AND）和或（OR），它们可以用来组合多个条件，并且根据不同的逻辑关系来判断结果是否符合要求。

总之，关系代数运算符是关系数据库中常用的操作工具，可以帮助用户更加方便地管理和查询数据。

### 4.2 传统的集合运算

传统的集合运算是指针对两个关系之间的运算。其中，笛卡尔积是一种特殊的集合运算，可以将两个关系中的元素组合成一个新的关系。但是，并、交、差三种运算需要满足一定的条件才能进行。

具体来说，如果想要进行并、交、差三种运算，那么参与运算的两个关系必須是相容的。所谓相容，指的是这两个关系必须具有相同的度数，而且它们中相对应的属性必须来自于同一个域。

换句话说，只有当两个关系在结构上相似时，才能够进行并、交、差等集合运算。这是因为在这些运算中，我们需要比较两个关系中的元素是否相同，而只有在它们的结构相似的情况下，我们才能够进行这样的比较。

因此，在实际应用中，如果我们需要进行集合运算，就需要先确保所涉及的关系是相容的，才能够得到正确的结果。这也是为什么在数据库设计和数据处理等领域中，经常会涉及到关系模型和关系代数等相关概念的原因之一。

### - 交


在数据库中，关系代数是一种用于操作关系模型的方式。其中，关系的交运算是指从两个关系中找出同时存在的元素的操作。

具体来说，假设有两个关系R和S，它们的交运算是通过求出既属于R又属于S的所有元组来实现的。这个运算可以用符号“∩”表示，其结果记作R∩S。其中，“t∈R∩S”表示t是一个同时存在于R和S中的元组。

例如，假设有一个学生关系（包含学号、姓名、年龄等属性）和一个课程关系（包含课程编号、课程名称、授课教师等属性），那么这两个关系的交运算是可以用来查找同时选修了某门课程的学生信息。具体地，我们可以先将学生关系和课程关系做内连接，然后再筛选出符合条件的记录，即既有学生信息又有对应选课记录的记录。这样就可以得到既属于学生关系又属于课程关系的元组集合，也就是学生与课程的关系。

### - 并


在数据库中，关系（Relation）是一种数据结构，它由若干个属性（Attribute）组成，并且每个属性都有一个特定的数据类型。关系可以看作是一个表格，其中每一行代表一条记录，每一列代表一个属性。

当需要将两个关系合并时，可以使用并运算（Union）。并运算是指将两个关系的所有元组（Tuple）组合在一起形成一个新的关系。这个新的关系包含了原关系的所有元组，但是会去除重复的元组。

具体来说，如果两个关系 R 和 S 需要进行并运算，则可以使用公式 R∪S={t| t∈R 或 t∈S} 来计算它们的并集。这个公式的含义是，将 R 和 S 中所有的元组 t 组合起来，构成一个新的集合。这个新集合就是 R 和 S 的并集。

需要注意的是，在计算并集时，如果两个关系中有相同的元组，则只会保留其中一个。因此，如果两个关系中有完全相同的元组，那么在并集中的结果也会被去重。

### - 差

在数据库中，关系（Relation）是一种数据结构，它由若干个属性（Attribute）组成，并且每个属性都有一个特定的数据类型。关系可以看作是一个表格，其中每一行代表一条记录，每一列代表一个属性。

当我们要对两个关系进行比较时，我们可以使用差运算（Difference）。差运算是指从一个关系中删除另一个关系所包含的所有元素的过程。具体来说，如果我们有两个关系 R 和 S，那么它们的差运算可以表示为 R-S，即 R 中所有不属于 S 的元素组成的集合。

在数学符号上，R-S 表示为 {t | t∈R ∧ t∉S}。其中，t 是一个元组（Tuple），它包含了关系中的所有属性值。符号 ∧ 表示逻辑与，它要求两个条件都必须成立才能取到 true 值。符号 ∉ 表示不等于，它用于判断一个元素是否不在某个集合中。

因此，当我们执行 R-S 操作时，我们得到了一个新的关系，它只包含 R 中那些不属于 S 的元组。这个新的关系可以帮助我们更好地理解和分析数据，找出不同之处，或者排除一些不必要的信息。

### - 广义笛卡尔积


两个关系R和S分别有m和n个属性，其中包含k1和k2个元组。它们之间的广义笛卡尔积是一个(n+m)列、k1×k2行的关系，其中每个元组的前n列来自于R中的一条记录，后m列来自于S中的一条记录。这个关系可以表示为RS={tr AND ts | tr为R, ts为S}。

简单来说，广义笛卡尔积是指将两个关系中的所有可能组合成一个新的关系的过程。在这个过程中，每个新元组都由一个来自第一个关系的元组和一个来自第二个关系的元组组成。因此，广义笛卡尔积可以帮助我们找到两个关系之间所有的可能组合，并且可以用于数据分析和查询等操作。

### - 集合运算的现实意义



### 4.3 专门的关系运算


传统集合运算只考虑行的操作，无法满足关系数据库中多样化的查询需求。因此，专门的关系运算应运而生，它不仅能够从行的角度进行运算，还能够从列的角度进行运算，从而更加灵活地支持对数据的访问需求。

专门的关系运算包括选择、投影、连接和除等四种运算。其中，选择运算是指从关系中选取符合条件的记录；投影运算是指从关系中选取指定属性构成新的关系；连接运算是指将两个或多个关系按照一定条件连接起来形成一个新的关系；除运算是指在关系中去除重复的记录。

通过这些专门的关系运算，我们可以更加方便地对关系数据库中的数据进行查询和处理，提高工作效率。同时，也能够保证数据的安全性和完整性，避免数据丢失或者误操作的情况发生。

### - 选择运算


选择运算是数据库中的一种操作，其作用是从一个关系（即表格）中选出符合条件的元组（即记录）。选择运算不会改变原关系的结构，只是在行的方向上进行筛选。关系的列数也不会发生改变。

选择运算可以用符号“σ”表示，其语法为σF(R)={t|tt∈R∧F(t)=‘真’}。其中，“σ”代表选择运算符，“R”代表运算对象，也就是要进行选择操作的关系；“F”是一个逻辑表达式，它的值可以是“真”或“假”，用来判断每个元组是否符合要求；最后的结果就是一个新的关系，包含所有符合条件的元组。

举个例子，假设有一个学生信息表，包括学生的姓名、年龄、性别等字段。如果我们想要选出所有女生的信息，就可以使用选择运算，选择年龄大于等于18岁的女性，那么这个查询语句就是：

SELECT * FROM students WHERE gender='女' AND age>=18;

这个查询语句就相当于选择了学生信息表中符合条件的所有元组，并将它们组成一个新的关系返回给用户。这样就可以方便地获取需要的数据，而不必遍历整个关系。

### - 投影运算

投影运算是一种数据库操作，它的运算对象是一个关系（即一张表格），它可以从这个关系中选择出若干列来组成一个新的关系。投影运算是在列的方向上进行的，因此它会改变原来的关系结构，并且同时去掉一些列以及结果中重复的行。

投影运算可以使用符号π来进行表示，例如πA(R)，其中A是属性列，R是运算对象，πA(R)是从关系R中将所有元组在A属性列上的分量挑选出来并去掉重复的行的运算。也就是说，投影运算的结果是一个只包含指定属性列的新关系，而原来的元组则被保留下来。

需要注意的是，投影运算并不会影响到关系中的其他列，只是将不需要的列删除掉。此外，在进行投影运算时，如果两个或多个元组在指定属性列上的值相同，则只会保留其中一个元组，其余的会被删除。这种去重的操作可以帮助我们更好地处理数据，减少冗余信息，提高查询效率。

### - 连接运算


连接运算是指将两个或多个关系（即数据表）通过特定的条件进行关联，从而形成一个新的关系的操作。其目的是为了实现基于多个关系的查询操作。

连接的依据是两个关系在语义相同的属性组上的值之间是否满足一定的条件，一般形式为 A θ B，其中 θ 是比较运算符。连接运算可以看作是广义笛卡尔积运算的子集，在广义笛卡尔积的运算结果中找出满足 A θ B 的元组。因此，选择运算也可以表示为σAθB(R×S)，即连接运算是在广义笛卡尔积的基础上按照 A θ B 的条件进行选择运算的结果。

根据 θ 是否为“=”，我们将连接运算分为等值连接和非等值连接。等值连接中有一种特殊的连接——自然连接，它与等值连接有两个区别：自然连接要求两个关系中进行比较的属性必须是相同的属性名；自然连接在结果中会去掉重复的属性。因此，自然连接的一个前提是两个关系必须有相同的属性。

连接运算不一定是在两个关系中进行，也可以是一个关系自己和自己连接。

### - 除运算


给定的关系 R(X,Y) 和 S(Y,Z)，其中 X、Y、Z 是属性组。R 中的 Y 与 S 中的 Y 可以有不同的属性名，但必须出自相同的域集。R 与 S 的除运算是指将 R 中所有满足条件的元组在 X 属性列上的投影，即 P(X)，而这些元组的 Y 值所对应的像集 Y_x 包含了 S 在 Y 上的投影的集合。

除运算实际上就是保留被除关系中含有全部除关系中相同列的全部取值的元组（不包含相同的列），它是同时从行和列两个角度进行运算。简单来说，除运算是通过将一个关系 R 中符合条件的元组在某个属性列上投影，得到一个新的关系 P，并且要求这个新的关系 P 中的某些属性值必须来自另一个关系 S 中的相应属性值。这种运算常用于数据清洗和数据分析等领域。

## 五、用关系代数语言实现数据查询
